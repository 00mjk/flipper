<!doctype html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<meta name="generator" content="Docusaurus v2.0.0-alpha.50">
<script src="https://buttons.github.io/buttons.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.0/clipboard.min.js"></script>
<script src="/js/code-blocks-buttons.js"></script>
<script src="/js/google-analytics.js"></script>

<title data-react-helmet="true">Testing | Flipper</title>

<meta data-react-helmet="true" name="twitter:card" content="summary_large_image"><meta data-react-helmet="true" property="og:title" content="Testing | Flipper"><meta data-react-helmet="true" name="description" content="Developer tools are only used if they work. We have built APIs to test plugins."><meta data-react-helmet="true" property="og:description" content="Developer tools are only used if they work. We have built APIs to test plugins."><meta data-react-helmet="true" property="og:url" content="https://fbflipper.com//docs/extending/testing">

<link data-react-helmet="true" rel="shortcut icon" href="/img/icon.png">


<link rel="stylesheet" href="/styles.d468395a.css">


<link rel="preload" href="/styles.38381a1b.js" as="script">

<link rel="preload" href="/runtime~main.37783d69.js" as="script">

<link rel="preload" href="/main.04e1331b.js" as="script">

<link rel="preload" href="/1.7aba10b2.js" as="script">

<link rel="preload" href="/2.01ab4660.js" as="script">

<link rel="preload" href="/3.36ad8f69.js" as="script">

<link rel="preload" href="/1be78505.dd9d48b5.js" as="script">

<link rel="preload" href="/20ac7829.43ca4a9a.js" as="script">

<link rel="preload" href="/17896441.2f84182d.js" as="script">

<link rel="preload" href="/41b472df.55883924.js" as="script">

</head>
<body>

<div id="__docusaurus">
<nav class="navbar navbar--light navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><div aria-label="Navigation bar toggle" class="navbar__toggle" role="button" tabindex="0"><svg xmlns="http://www.w3.org/2000/svg" width="30" height="30" viewBox="0 0 30 30" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></div><a aria-current="page" class="navbar__brand active" href="/"><img class="navbar__logo" src="/img/icon.png" alt="Flipper Logo"><strong class="navbar__title">Flipper</strong></a></div><div class="navbar__items navbar__items--right"><a class="navbar__item navbar__link" href="/docs/features/index">Features</a><a class="navbar__item navbar__link" href="/docs/getting-started/index">Setup</a><a class="navbar__item navbar__link" href="/docs/extending/index">Extending</a><a target="_blank" rel="noopener noreferrer" href="https://github.com/facebook/flipper" class="navbar__item navbar__link">GitHub</a><div class="navbar__search"><span aria-label="expand searchbar" role="button" class="search-icon" tabindex="0"></span><input type="search" id="search_input_react" placeholder="Search" aria-label="Search" class="navbar__search-input search-bar"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div><div class="navbar-sidebar"><div class="navbar-sidebar__brand"><a aria-current="page" class="navbar__brand active" href="/"><img class="navbar__logo" src="/img/icon.png" alt="Flipper Logo"><strong class="navbar__title">Flipper</strong></a></div><div class="navbar-sidebar__items"><div class="menu"><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" href="/docs/features/index">Features</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/getting-started/index">Setup</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/extending/index">Extending</a></li><li class="menu__list-item"><a target="_blank" rel="noopener noreferrer" href="https://github.com/facebook/flipper" class="menu__link">GitHub</a></li></ul></div></div></div></nav><div class="main-wrapper"><div class="docPage_1kjD"><div class="docSidebarContainer_1cYp"><div class="sidebar_1kLs"><div class="menu menu--responsive menu_w2sC"><button aria-label="Open Menu" aria-haspopup="true" class="button button--secondary button--sm menu__button" type="button"><svg aria-label="Menu" class="sidebarMenuIcon_2vk4" xmlns="http://www.w3.org/2000/svg" height="24" width="24" viewBox="0 0 32 32" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><ul class="menu__list"><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Extending Flipper</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" href="/docs/extending/index">Clients and Plugins</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Tutorial</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" href="/docs/tutorial/intro">Intro</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/tutorial/ios">Building an iOS Plugin</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/tutorial/android">Building an Android Plugin</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/tutorial/react-native">Building a React Native Plugin</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/tutorial/js-setup">Building a Desktop Plugin</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/tutorial/js-table">Showing a table</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/tutorial/js-custom">Custom UI</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/tutorial/js-publishing">Publishing</a></li></ul></li><li class="menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#!">Plugin Development</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" href="/docs/extending/js-setup">Desktop Plugin Development</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/extending/js-plugin-api">Desktop Plugin API</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/extending/create-table-plugin">Create Table Plugin</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/extending/ui-components">UI Components</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/extending/styling-components">Styling Components</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/extending/search-and-filter">Searching and Filtering</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/extending/create-plugin">Client Plugin API</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/extending/client-plugin-lifecycle">Client Plugin Lifecycle</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/extending/send-data">Providing Data to Plugins</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/extending/error-handling">Error Handling</a></li><li class="menu__list-item"><a aria-current="page" class="menu__link menu__link--active" href="/docs/extending/testing">Testing</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/extending/debugging">Debugging</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Other Platforms</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" href="/docs/extending/new-clients">Implementing a Flipper Client</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/extending/establishing-a-connection">Secure Communication</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/extending/supporting-layout">Implementing Layout Inspection</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Internals</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" href="/docs/extending/arch">Architecture</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/extending/layout-inspector">Extending Layout Inspector</a></li></ul></li></ul></div></div></div><main class="docMainContainer_FFX1"><div class="padding-vert--lg"><div class="container"><div class="row"><div class="col docItemCol_2GOA"><div class="docItemContainer_2cwg"><article><header><h1 class="docTitle_1vWb">Testing</h1></header><div class="markdown"><p>Developer tools are only used if they work. We have built APIs to test plugins.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="android"></a><a aria-hidden="true" tabindex="-1" class="hash-link" href="#android" title="Direct link to heading">#</a>Android</h2><p>Start by creating your first test file in this directory <code>MyFlipperPluginTest.java</code>. In the test method body we create our plugin which we want to test as well as a <code>FlipperConnectionMock</code>. In this contrived example we simply assert that our plugin&#x27;s connected status is what we expect.</p><div class="mdxCodeBlock_iHAB"><div class="codeBlockContent_32p_"><button type="button" aria-label="Copy code to clipboard" class="copyButton_1BYj">Copy</button><div tabindex="0" class="prism-code language-java codeBlock_19pQ"><div class="codeBlockLines_2n9r" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token annotation punctuation" style="color:rgb(199, 146, 234)">@RunWith</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token class-name" style="color:rgb(255, 203, 107)">RobolectricTestRunner</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token keyword" style="font-style:italic">class</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token keyword" style="font-style:italic">public</span><span class="token plain"> </span><span class="token keyword" style="font-style:italic">class</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(255, 203, 107)">MyFlipperPluginTest</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token annotation punctuation" style="color:rgb(199, 146, 234)">@Test</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token keyword" style="font-style:italic">public</span><span class="token plain"> </span><span class="token keyword" style="font-style:italic">void</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">myTest</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token keyword" style="font-style:italic">final</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(255, 203, 107)">MyFlipperPlugin</span><span class="token plain"> plugin </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token keyword" style="font-style:italic">new</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(255, 203, 107)">MyFlipperPlugin</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token keyword" style="font-style:italic">final</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(255, 203, 107)">FlipperConnectionMock</span><span class="token plain"> connection </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token keyword" style="font-style:italic">new</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(255, 203, 107)">FlipperConnectionMock</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    plugin</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token function" style="color:rgb(130, 170, 255)">onConnect</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">connection</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token function" style="color:rgb(130, 170, 255)">assertThat</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">plugin</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token function" style="color:rgb(130, 170, 255)">connected</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">equalTo</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token boolean" style="color:rgb(255, 88, 116)">true</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span></div></div></div></div></div><p>There are two mock classes that are used to construct tests <code>FlipperConnectionMock</code> and <code>FlipperResponderMock</code>. Together these can be used to write very powerful tests to verify the end to end behavior of your plugin. For example we can test if for a given incoming message our plugin responds as we expect.</p><div class="mdxCodeBlock_iHAB"><div class="codeBlockContent_32p_"><button type="button" aria-label="Copy code to clipboard" class="copyButton_1BYj">Copy</button><div tabindex="0" class="prism-code language-java codeBlock_19pQ"><div class="codeBlockLines_2n9r" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token annotation punctuation" style="color:rgb(199, 146, 234)">@Test</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token keyword" style="font-style:italic">public</span><span class="token plain"> </span><span class="token keyword" style="font-style:italic">void</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">myTest</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token keyword" style="font-style:italic">final</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(255, 203, 107)">MyFlipperPlugin</span><span class="token plain"> plugin </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token keyword" style="font-style:italic">new</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(255, 203, 107)">MyFlipperPlugin</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token keyword" style="font-style:italic">final</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(255, 203, 107)">FlipperConnectionMock</span><span class="token plain"> connection </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token keyword" style="font-style:italic">new</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(255, 203, 107)">FlipperConnectionMock</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token keyword" style="font-style:italic">final</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(255, 203, 107)">FlipperResponderMock</span><span class="token plain"> responder </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token keyword" style="font-style:italic">new</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(255, 203, 107)">FlipperResponderMock</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  plugin</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token function" style="color:rgb(130, 170, 255)">onConnect</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">connection</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token keyword" style="font-style:italic">final</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(255, 203, 107)">FlipperObject</span><span class="token plain"> params </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token keyword" style="font-style:italic">new</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(255, 203, 107)">FlipperObject</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token class-name" style="color:rgb(255, 203, 107)">Builder</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token function" style="color:rgb(130, 170, 255)">put</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token string" style="color:rgb(195, 232, 141)">&quot;phrase&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;flipper&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token function" style="color:rgb(130, 170, 255)">build</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  connection</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">receivers</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token function" style="color:rgb(130, 170, 255)">get</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token string" style="color:rgb(195, 232, 141)">&quot;myMethod&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token function" style="color:rgb(130, 170, 255)">onReceive</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">params</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> responder</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token function" style="color:rgb(130, 170, 255)">assertThat</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">responder</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">successes</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">hasItem</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token keyword" style="font-style:italic">new</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(255, 203, 107)">FlipperObject</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token class-name" style="color:rgb(255, 203, 107)">Builder</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">          </span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token function" style="color:rgb(130, 170, 255)">put</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token string" style="color:rgb(195, 232, 141)">&quot;phrase&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;ranos&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">          </span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token function" style="color:rgb(130, 170, 255)">build</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span></div></div></div></div></div><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="c"></a><a aria-hidden="true" tabindex="-1" class="hash-link" href="#c" title="Direct link to heading">#</a>C++</h2><p>Start by creating your first test file in this directory <code>MyFlipperPluginTests.cpp</code> and import the testing utilities from <code>fbsource//xplat/sonar/xplat:FlipperTestLib</code>. These utilities mock out core pieces of the communication channel so that you can test your plugin in isolation.</p><div class="mdxCodeBlock_iHAB"><div class="codeBlockContent_32p_"><button type="button" aria-label="Copy code to clipboard" class="copyButton_1BYj">Copy</button><div tabindex="0" class="prism-code language-undefined codeBlock_19pQ"><div class="codeBlockLines_2n9r" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">#include &lt;MyFlipperPlugin/MyFlipperPlugin.h&gt;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">#include &lt;FlipperTestLib/FlipperConnectionMock.h&gt;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">#include &lt;FlipperTestLib/FlipperResponderMock.h&gt;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">#include &lt;folly/json.h&gt;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">#include &lt;gtest/gtest.h&gt;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">namespace facebook {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">namespace flipper {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">namespace test {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">TEST(MyFlipperPluginTests, testDummy) {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  EXPECT_EQ(1 + 1, 2);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">}</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">} // namespace test</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">} // namespace flipper</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">} // namespace facebook</span></div></div></div></div></div><p>Here is a simple test using these mock utilities to create a plugin, send some data, and assert that the result is as expected.</p><div class="mdxCodeBlock_iHAB"><div class="codeBlockContent_32p_"><button type="button" aria-label="Copy code to clipboard" class="copyButton_1BYj">Copy</button><div tabindex="0" class="prism-code language-undefined codeBlock_19pQ"><div class="codeBlockLines_2n9r" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">TEST(MyFlipperPluginTests, testDummy) {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  std::vector&lt;folly::dynamic&gt; successfulResponses;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  auto responder = std::make_unique&lt;FlipperResponderMock&gt;(&amp;successfulResponses);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  auto conn = std::make_shared&lt;FlipperConnectionMock&gt;();</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  MyFlipperPlugin plugin;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  plugin.didConnect(conn);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  folly::dynamic message = folly::dynamic::object(&quot;param1&quot;, &quot;hello&quot;);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  folly::dynamic expectedResponse = folly::dynamic::object(&quot;response&quot;, &quot;Hi there&quot;);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  auto receiver = conn-&gt;receivers_[&quot;someMethod&quot;];</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  receiver(message, std::move(responder));</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  EXPECT_EQ(successfulResponses.size(), 1);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  EXPECT_EQ(successfulResponses.back(), expectedResponse);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">}</span></div></div></div></div></div><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="testing-the-flipper-desktop-plugin"></a><a aria-hidden="true" tabindex="-1" class="hash-link" href="#testing-the-flipper-desktop-plugin" title="Direct link to heading">#</a>Testing the Flipper Desktop Plugin</h2><p>Tests should be put in the <code>__tests__</code> directory of your plugin sources, and be created using Jest.
An example test suite can be found <a href="https://github.com/facebook/flipper/blob/master/desktop/plugins/layout/__tests__/ProxyArchiveClient.node.tsx">here</a>.</p><p>Flipper exposes an API to generate unit tests that can verify <em>regressions</em> and real life scenarios.
To generate a unit test:</p><ol><li>Start flipper.</li><li>Open your plugin.</li><li>Open the Developer Tools (<code>View &gt; Open Developer Tools</code>).</li><li>In the console, call the function <code>flipperStartPluginRecording()</code>.</li><li>Interact with your application, in such a way that new events are created for your plugin.</li><li>Once you generated an interesting amount and diversity of events, call <code>flipperStopPluginRecording()</code> from the Flipper console.</li><li>This process will have generated a unit test and a snapshot file with the data (the console will report where). Move those files to your <code>__tests__</code> directory.</li><li>The unit test should succeed if it is run using Jest. Feel free to modify the unit test to your needs. In the future you might want to record new snapshot data files if the plugin changes.</li></ol></div></article><div class="margin-vert--xl"><div class="row"><div class="col"><a href="https://github.com/facebook/flipper/blob/master/website/../docs/extending/testing.mdx" target="_blank" rel="noreferrer noopener"><svg fill="currentColor" height="1.2em" width="1.2em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 40 40" style="margin-right:0.3em;vertical-align:sub"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div></div></div><div class="margin-vert--lg"><nav class="pagination-nav"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/docs/extending/error-handling"><div class="pagination-nav__link--sublabel">Previous</div><div class="pagination-nav__link--label">« Error Handling</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/docs/extending/debugging"><div class="pagination-nav__link--sublabel">Next</div><div class="pagination-nav__link--label">Debugging »</div></a></div></nav></div></div></div><div class="col col--3"><div class="tableOfContents_TbNY"><ul class="contents contents__left-border"><li><a href="#android" class="contents__link">Android</a></li><li><a href="#c" class="contents__link">C++</a></li><li><a href="#testing-the-flipper-desktop-plugin" class="contents__link">Testing the Flipper Desktop Plugin</a></li></ul></div></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container"><div class="row footer__links"><div class="col footer__col"><h4 class="footer__title">Learn</h4><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/docs/getting-started/index">Getting Started</a></li><li class="footer__item"><a class="footer__link-item" href="/docs/tutorial/intro">Plugin Creation Tutorial</a></li></ul></div><div class="col footer__col"><h4 class="footer__title">Plugins</h4><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/docs/features">Core Plugins</a></li><li class="footer__item"><a class="footer__link-item" to="https://www.npmjs.com/search?q=keywords:flipper-plugin" href="https://www.npmjs.com/search?q=keywords:flipper-plugin">Community Plugins</a></li></ul></div><div class="col footer__col"><h4 class="footer__title">More</h4><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" to="https://twitter.com/flipper_fb" href="https://twitter.com/flipper_fb">Twitter</a></li><li class="footer__item"><a class="footer__link-item" to="https://github.com/facebook/flipper" href="https://github.com/facebook/flipper">GitHub</a></li></ul></div></div><div class="text--center"><div class="margin-bottom--sm"><img class="footer__logo" alt="Flipper Mascot" src="/img/mascot.png"></div><div>Copyright © 2020 Facebook</div></div></div></footer>
</div>

<script src="/styles.38381a1b.js"></script>

<script src="/runtime~main.37783d69.js"></script>

<script src="/main.04e1331b.js"></script>

<script src="/1.7aba10b2.js"></script>

<script src="/2.01ab4660.js"></script>

<script src="/3.36ad8f69.js"></script>

<script src="/1be78505.dd9d48b5.js"></script>

<script src="/20ac7829.43ca4a9a.js"></script>

<script src="/17896441.2f84182d.js"></script>

<script src="/41b472df.55883924.js"></script>


</body>
</html>